<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.GuestBookMapper">

	<!--  회원 가입  -->
	<insert id="saveMember">
		insert into member (
			id,
			password,
			name			
		) values (
			#{id},
			#{password},
			#{name}
		)	
	</insert>
	<!--  회원정보 검색(로그인)  -->
	<select id="findMemberById" resultType="member">
		select
			id,
			password,
			name
		from
			member
		where
			id = #{id}
	</select>
	
	<!--  방명록 작성  -->
	<insert id="saveGuestBook">
		<selectKey keyProperty="id" resultType="long" order="BEFORE">
			select SEQ_GUESTBOOK.nextval from dual
		</selectKey>
		insert into guestbook(
			id,
			member_id,
			contents
		) values (
			#{id},
			#{member_id},
			#{contents}			
		)
	</insert>
	
	<!--  방명록 전체 목록 -->
	<select id="findGuestBooks" resultType="guestbook">
		select
			id,
			member_id,
			contents,
			hit,
			input_date
		from
			guestbook
		order by
			input_date desc
	</select>
	
	<!--  방명록 검색  -->
	<select id="findGuestBookById" resultType="guestbook">
		select
			id,
			member_id,
			contents,
			hit,
			input_date
		from
			guestbook
		where
			id = #{id}
	</select>

	<!--  방명록 조회수 증가  -->
	<update id="addGuestBookHit">
		update guestbook
		set
			hit = hit+1
		where
			id = #{id}
	</update>

	<!--  방명록 수정  -->
	<update id="updateGuestBook">
		update guestbook
		set
			contents = #{contents}
		where
			id = #{id}
	</update>

	<!--  방명록 삭제  -->
	<delete id="removeGuestBook">
		delete from guestbook
		where
			id = #{id}
	</delete>
	
</mapper>